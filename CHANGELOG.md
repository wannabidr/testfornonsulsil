# 변경 사항 (Verilog-2001 표준 준수)

## 주요 수정 내용

### 1. FSM 구조 개선
- **이전**: 조합논리(`always @(*)`)와 순차논리 분리, `next_state` 사용
- **이후**: 단일 순차논리 블록으로 통합, 상태 전이 직접 처리
- **이유**: 조합논리에서 `state` 참조 시 순환 논리 문제 방지

### 2. 클럭 분주 방식 변경
- **이전**: 1MHz LCD 클럭 생성 (50분주)
- **이후**: 1kHz LCD 제어 신호 생성 (100000분주)
- **이유**: LCD 타이밍 여유 확보, Enable 펄스 폭 안정화

### 3. 타이밍 간소화
- **이전**: 복잡한 Enable 펄스 생성 로직, 50μs 대기
- **이후**: 각 상태에서 1ms 단위 직접 제어
- **이유**: HD44780 타이밍 여유 충분, 코드 간결성 향상

### 4. 비트 슬라이싱 개선
- **이전**: `line1[127 - (char_count-1)*8 -: 8]`
- **이후**: `line1[(15-char_count)*8 +: 8]`
- **이유**: 계산 간소화, Verilog-2001 표준 권장 형식

### 5. 초기화 방식 변경
- **이전**: 리셋 블록에서 concatenation 사용 (`{"M", "o", ...}`)
- **이후**: 개별 비트 범위 할당 (`line1[127:120] <= 8'h4D`)
- **이유**: 합성 도구 호환성 향상

### 6. 상태 수 최적화
- **이전**: 13개 상태 (WRITE_CHAR, WAIT_DONE 등)
- **이후**: 14개 상태 (SET_ADDR1/2 추가, 불필요한 상태 제거)
- **이유**: 명확한 주소 설정, 문자 출력 로직 분리

## Verilog-2001 표준 준수 체크리스트

✅ 포트 선언: ANSI-C 스타일 인라인 선언 사용  
✅ 데이터 타입: `reg`, `wire` 명확히 구분  
✅ 연산자: 비트 슬라이싱 `+:`, `-:` 사용  
✅ always 블록: 순차논리만 사용, 민감도 리스트 명확  
✅ 초기화: 리셋 신호로 초기화, `initial` 블록 미사용  
✅ localparam: 상수 정의에 사용  
✅ case 문: `default` 케이스 추가  

## 테스트 가이드

1. **문법 검증**: Vivado에서 Syntax Check 수행
2. **합성 검증**: Synthesis 실행, 타이밍 위배 확인
3. **시뮬레이션**: 초기화 시퀀스 및 문자 출력 동작 확인
4. **하드웨어 테스트**: HBE-Combo 2-DLD 보드에 다운로드

## 알려진 제한사항

1. `refresh` 신호는 READY_STATE에서만 감지됨
2. LCD 업데이트 시간: 약 34ms (초기화 제외)
3. 동적 문자열 변경 시 `refresh` 재활성화 필요
